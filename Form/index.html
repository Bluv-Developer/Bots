<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bluv Development | Bot Form</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                        mono: ['Space Mono', 'monospace'],
                    },
                    colors: {
                        earth: {
                            900: '#1c1917',
                            800: '#292524',
                            700: '#44403c',
                            600: '#57534e',
                            500: '#78716c',
                            400: '#a8a29e',
                            300: '#d6d3d1',
                            200: '#e7e5e4',
                            100: '#f5f5f4',
                        },
                        tan: {
                            accent: '#d4b483',
                            glow: 'rgba(212, 180, 131, 0.3)'
                        }
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'fade-in': 'fadeIn 0.5s ease-out forwards',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'flash-red': 'flashRed 2s infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        flashRed: {
                            '0%, 100%': { opacity: 1 },
                            '50%': { opacity: 0.5 },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #1c1917;
            color: #e7e5e4;
            user-select: none;
            -webkit-user-select: none;
        }

        /* Glassmorphism Panels */
        .glass-panel {
            background: rgba(41, 37, 36, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(212, 180, 131, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        .input-casual {
            background-color: rgba(28, 25, 23, 0.5);
            border: 1px solid #44403c;
            color: #fff;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .input-casual:focus {
            outline: none;
            border-color: #d4b483;
            background-color: rgba(28, 25, 23, 0.9);
            box-shadow: 0 0 15px rgba(212, 180, 131, 0.1);
            transform: scale(1.01);
        }
        
        .input-error {
            border-color: #ef4444 !important;
            box-shadow: 0 0 10px rgba(239, 68, 68, 0.2) !important;
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        
        .error-msg {
            color: #ef4444;
            font-size: 0.75rem;
            margin-top: 0.25rem;
            display: none;
            font-weight: 500;
        }
        .input-error + .error-msg {
            display: block;
        }

        #custom-context-menu {
            position: absolute;
            z-index: 1000;
            display: none;
            background: rgba(28, 25, 23, 0.95);
            border: 1px solid #44403c;
            border-radius: 8px;
            padding: 8px 0;
            min-width: 180px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }
        .ctx-item {
            padding: 8px 16px;
            font-size: 14px;
            color: #d6d3d1;
            cursor: pointer;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .ctx-item:hover {
            background: rgba(212, 180, 131, 0.1);
            color: #d4b483;
        }

        .step-panel { display: none; animation: fadeIn 0.6s ease-out; }
        .step-panel.active { display: block; }
        img { pointer-events: none; }
        
        .color-status {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-top: 4px;
            font-weight: bold;
        }
        
        /* Break long IDs */
        .break-ids {
            word-break: break-all;
            overflow-wrap: break-word;
        }
        
        /* Permission Grid */
        .perm-checkbox:checked + div {
            background-color: rgba(212, 180, 131, 0.2);
            border-color: #d4b483;
        }
        
        .danger-tooltip {
            visibility: hidden;
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #7f1d1d;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 10px;
            width: 200px;
            text-align: center;
            z-index: 10;
            margin-bottom: 5px;
            border: 1px solid #ef4444;
        }
        
        .danger-icon:hover + .danger-tooltip {
            visibility: visible;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col font-sans" oncontextmenu="return false;">

    <!-- Context Menu -->
    <div id="custom-context-menu">
        <div class="ctx-item" onclick="location.reload()"><i class="fas fa-redo"></i> Refresh Form</div>
        <div class="ctx-item" onclick="resetForm()"><i class="fas fa-eraser"></i> Clear Answers</div>
        <div class="border-t border-earth-700 my-1"></div>
        <div class="ctx-item text-xs text-earth-500 cursor-default hover:bg-transparent">Powered by Bluv</div>
    </div>

    <!-- Header -->
    <header class="sticky top-0 z-50 glass-panel border-b-0 mb-8">
        <div class="max-w-6xl mx-auto px-6 h-28 flex flex-col md:flex-row items-center justify-between">
            <div class="flex items-center gap-4 w-full md:w-auto">
                <img src="https://ik.imagekit.io/tycncf0zq0/Bluv%20Bots.png?updatedAt=1765122635616" alt="Bluv Bots" class="h-14 w-auto object-contain">
                <div class="flex flex-col border-l border-earth-600 pl-4 h-10 justify-center">
                    <div class="flex items-center gap-2 text-[10px] font-mono text-earth-400 tracking-tight">
                        <a href="https://bluv-developer.github.io/Bluv" target="_blank" class="hover:text-tan-accent transition-colors">Bluv Development</a>
                        <i class="fas fa-chevron-right text-[8px]"></i>
                        <a href="https://bluv-developer.github.io/Bots/" target="_blank" class="hover:text-tan-accent transition-colors">Discord Bots</a>
                        <i class="fas fa-chevron-right text-[8px]"></i>
                        <span class="text-tan-accent">Form</span>
                    </div>
                    <span class="text-xl font-bold text-white tracking-wide">Bots Form</span>
                </div>
            </div>
            
            <div class="flex items-center gap-4 mt-3 md:mt-0 w-full md:w-auto justify-end">
                <a href="https://discord.gg/KmHfjDm2WA" target="_blank" class="text-xs bg-[#5865F2]/10 hover:bg-[#5865F2] hover:text-white text-[#5865F2] px-4 py-2 rounded-lg border border-[#5865F2]/30 transition-all font-bold">
                    <i class="fab fa-discord mr-1"></i> Community
                </a>
                <div class="text-sm font-mono text-earth-400 bg-earth-800/50 px-4 py-2 rounded-lg border border-earth-700 animate-pulse-slow">
                    Step <span id="step-indicator" class="text-tan-accent font-bold text-lg">1</span> / 5
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow flex flex-col items-center justify-start px-6 pb-32">
        <form id="botForm" class="w-full max-w-5xl space-y-10">
            
            <!-- STEP 1: BASICS -->
            <div id="step-1" class="step-panel active">
                <div class="glass-panel rounded-3xl p-8 md:p-12 transition-all">
                    <div class="mb-10 border-b border-earth-700 pb-4">
                        <h1 class="text-4xl font-light text-white mb-2">The Basics</h1>
                        <p class="text-earth-400">Essential information to get us started.</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="space-y-6">
                            <h3 class="text-xs font-bold text-tan-accent uppercase tracking-widest flex items-center gap-2">
                                <i class="fas fa-user-circle"></i> Your Info
                            </h3>
                            <div>
                                <label class="block text-xs text-earth-400 mb-2">Discord Username <span class="text-red-500">*</span></label>
                                <input type="text" name="client_discord" required class="input-casual w-full p-4 rounded-xl font-mono" placeholder="Username#0000">
                                <p class="error-msg">This field is required.</p>
                            </div>
                            <div>
                                <label class="block text-xs text-earth-400 mb-2">Discord ID <span class="text-red-500">*</span></label>
                                <input type="text" name="client_id" required class="input-casual w-full p-4 rounded-xl font-mono" placeholder="123456789...">
                                <p class="error-msg">This field is required.</p>
                            </div>
                             <div>
                                <label class="block text-xs text-earth-400 mb-2">Timezone (Optional)</label>
                                <input type="text" name="client_timezone" class="input-casual w-full p-4 rounded-xl font-mono" placeholder="e.g. EST, GMT+1">
                            </div>
                        </div>

                        <div class="space-y-6">
                            <h3 class="text-xs font-bold text-tan-accent uppercase tracking-widest flex items-center gap-2">
                                <i class="fas fa-server"></i> Server Info
                            </h3>
                            <div>
                                <label class="block text-xs text-earth-400 mb-2">Server Name <span class="text-red-500">*</span></label>
                                <input type="text" name="server_name" required class="input-casual w-full p-4 rounded-xl" placeholder="My Awesome Server">
                                <p class="error-msg">This field is required.</p>
                            </div>
                            <div>
                                <label class="block text-xs text-earth-400 mb-2">Server Invite Link <span class="text-red-500">*</span></label>
                                <input type="text" name="server_invite" required class="input-casual w-full p-4 rounded-xl" placeholder="discord.gg/...">
                                <p class="error-msg">This field is required.</p>
                            </div>
                        </div>

                        <div class="md:col-span-2 mt-4 pt-6 border-t border-earth-700/50">
                            <h3 class="text-xs font-bold text-tan-accent uppercase tracking-widest mb-6 flex items-center gap-2">
                                <i class="fas fa-robot"></i> Bot Identity
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div>
                                    <label class="block text-xs text-earth-400 mb-2">Bot Name <span class="text-red-500">*</span></label>
                                    <input type="text" name="bot_name" required class="input-casual w-full p-4 rounded-xl" placeholder="Helper Bot">
                                    <p class="error-msg">This field is required.</p>
                                </div>
                                <div>
                                    <label class="block text-xs text-earth-400 mb-2">Prefix <span class="text-red-500">*</span></label>
                                    <select name="bot_prefix" required class="input-casual w-full p-4 rounded-xl cursor-pointer">
                                        <option value="/">Slash Commands (/)</option>
                                        <option value="!">Exclamation (!)</option>
                                        <option value="?">Question (?)</option>
                                        <option value=".">Dot (.)</option>
                                        <option value="$">Money ($)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs text-earth-400 mb-2">Status <span class="text-red-500">*</span></label>
                                    <select name="bot_status" required class="input-casual w-full p-4 rounded-xl cursor-pointer">
                                        <option value="Online">Online</option>
                                        <option value="Idle">Idle</option>
                                        <option value="Do Not Disturb">Do Not Disturb</option>
                                        <option value="Invisible">Invisible</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Enhanced Color Picker -->
                            <div class="mt-6 p-6 bg-earth-800/30 rounded-xl border border-earth-700 transition-colors hover:border-tan-accent/30">
                                <label class="block text-xs text-earth-400 mb-2">Bot Color Theme <span class="text-red-500">*</span></label>
                                <div class="flex flex-col md:flex-row gap-4 items-start md:items-center">
                                    <div class="relative w-full md:w-1/2">
                                        <select id="colorSelect" name="theme_color_select" onchange="handleColorChange()" class="input-casual w-full p-4 pl-12 rounded-xl cursor-pointer appearance-none">
                                            <option value="#3b82f6" data-color="#3b82f6">Bluv Blue</option>
                                            <option value="#d4b483" data-color="#d4b483">Casual Tan</option>
                                            <option value="#000000" data-color="#000000">Midnight Black</option>
                                            <option value="#ffffff" data-color="#ffffff">Classic White</option>
                                            <option value="#ef4444" data-color="#ef4444">Alert Red</option>
                                            <option value="#22c55e" data-color="#22c55e">Success Green</option>
                                            <option value="custom" data-color="transparent">Custom Color...</option>
                                        </select>
                                        <div id="colorPreview" class="absolute left-4 top-1/2 transform -translate-y-1/2 w-6 h-6 rounded-full border border-earth-500 bg-blue-500 shadow-lg transition-all duration-300"></div>
                                    </div>
                                    <div class="w-full md:w-1/2 hidden animate-fade-in" id="customColorContainer">
                                        <input type="text" id="customColorInput" name="custom_theme_color" class="input-casual w-full p-4 rounded-xl" placeholder="e.g. #FF0000 or Red">
                                        <div id="colorValidationMsg" class="color-status"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-8 flex justify-between items-center">
                    <div class="flex items-center gap-2 opacity-70">
                        <img src="https://ik.imagekit.io/tycncf0zq0/Bluv%20%20(1).png" class="w-5 h-5">
                        <span class="text-xs font-mono text-earth-400">Powered by Bluv</span>
                    </div>
                    <button type="button" onclick="validateAndNext(1)" class="bg-tan-accent hover:bg-white text-earth-900 px-10 py-4 rounded-xl font-bold transition-all shadow-lg hover:shadow-tan-accent/50 transform hover:-translate-y-1">
                        Next Step <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>

            <!-- STEP 2: COMMANDS -->
            <div id="step-2" class="step-panel">
                <div class="glass-panel rounded-3xl p-8 md:p-12">
                    <div class="flex flex-col md:flex-row justify-between items-end mb-8 border-b border-earth-700 pb-6 gap-4">
                        <div>
                            <h1 class="text-4xl font-light text-white mb-2">Commands</h1>
                            <p class="text-earth-400">Define your bot's functionality. Be specific!</p>
                        </div>
                        <button type="button" onclick="addCommandRow()" class="text-xs bg-earth-800 border border-earth-600 hover:border-tan-accent text-earth-300 hover:text-white px-6 py-3 rounded-xl transition-all shadow-md flex items-center gap-2">
                            <i class="fas fa-plus"></i> Add Command
                        </button>
                    </div>

                    <!-- In-page Error Container -->
                    <div id="cmd-error-banner" class="hidden mb-6 p-4 bg-red-900/40 border border-red-500/50 rounded-xl text-red-200 text-sm flex items-center gap-3 animate-pulse">
                        <i class="fas fa-exclamation-circle text-lg"></i>
                        <span>Please add at least 1 command before proceeding.</span>
                    </div>

                    <div id="commands-container" class="space-y-6">
                        <div id="empty-commands" class="text-center py-20 border-2 border-dashed border-earth-700 rounded-2xl bg-earth-800/30">
                            <i class="fas fa-robot text-4xl text-earth-600 mb-4 animate-float"></i>
                            <p class="text-earth-400 text-sm">No commands yet. Click "Add Command" to start.</p>
                        </div>
                    </div>
                </div>

                <div class="mt-8 flex justify-between items-center">
                    <div class="flex items-center gap-2 opacity-70">
                        <img src="https://ik.imagekit.io/tycncf0zq0/Bluv%20%20(1).png" class="w-5 h-5">
                        <span class="text-xs font-mono text-earth-400">Powered by Bluv</span>
                    </div>
                    <div class="flex gap-4">
                        <button type="button" onclick="changeStep(1)" class="text-earth-400 hover:text-white px-8 py-4 font-medium transition-colors">Back</button>
                        <button type="button" onclick="validateAndNext(2)" class="bg-tan-accent hover:bg-white text-earth-900 px-10 py-4 rounded-xl font-bold transition-all shadow-lg hover:shadow-tan-accent/50 transform hover:-translate-y-1">
                            Next Step <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- STEP 3: FEATURES -->
            <div id="step-3" class="step-panel">
                <div class="glass-panel rounded-3xl p-8 md:p-12">
                    <div class="flex flex-col md:flex-row justify-between items-end mb-8 border-b border-earth-700 pb-6 gap-4">
                        <div>
                            <h1 class="text-4xl font-light text-white mb-2">Features</h1>
                            <p class="text-earth-400">Passive systems (Welcomer, Logging, Auto-mod).</p>
                        </div>
                        <button type="button" onclick="addFeatureRow()" class="text-xs bg-earth-800 border border-earth-600 hover:border-tan-accent text-earth-300 hover:text-white px-6 py-3 rounded-xl transition-all shadow-md flex items-center gap-2">
                            <i class="fas fa-plus"></i> Add Feature
                        </button>
                    </div>

                    <!-- In-page Error Container -->
                    <div id="feat-error-banner" class="hidden mb-6 p-4 bg-red-900/40 border border-red-500/50 rounded-xl text-red-200 text-sm flex items-center gap-3 animate-pulse">
                        <i class="fas fa-exclamation-circle text-lg"></i>
                        <span>Please add at least 3 features before proceeding.</span>
                    </div>

                    <div id="features-container" class="space-y-6">
                        <div id="empty-features" class="text-center py-20 border-2 border-dashed border-earth-700 rounded-2xl bg-earth-800/30">
                            <i class="fas fa-magic text-4xl text-earth-600 mb-4 animate-float"></i>
                            <p class="text-earth-400 text-sm">No features yet. Click "Add Feature" to start.</p>
                        </div>
                    </div>
                </div>

                <div class="mt-8 flex justify-between items-center">
                    <div class="flex items-center gap-2 opacity-70">
                        <img src="https://ik.imagekit.io/tycncf0zq0/Bluv%20%20(1).png" class="w-5 h-5">
                        <span class="text-xs font-mono text-earth-400">Powered by Bluv</span>
                    </div>
                    <div class="flex gap-4">
                        <button type="button" onclick="changeStep(2)" class="text-earth-400 hover:text-white px-8 py-4 font-medium transition-colors">Back</button>
                        <button type="button" onclick="validateAndNext(3)" class="bg-tan-accent hover:bg-white text-earth-900 px-10 py-4 rounded-xl font-bold transition-all shadow-lg hover:shadow-tan-accent/50 transform hover:-translate-y-1">
                            Next Step <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- STEP 4: ROLES & PERMISSIONS -->
            <div id="step-4" class="step-panel">
                <div class="glass-panel rounded-3xl p-8 md:p-12">
                    <div class="flex flex-col md:flex-row justify-between items-end mb-8 border-b border-earth-700 pb-6 gap-4">
                        <div>
                            <h1 class="text-4xl font-light text-white mb-2">Roles & Permissions</h1>
                            <p class="text-earth-400">Configure your staff team and their capabilities.</p>
                        </div>
                        <button type="button" onclick="addRoleRow()" class="text-xs bg-earth-800 border border-earth-600 hover:border-tan-accent text-earth-300 hover:text-white px-6 py-3 rounded-xl transition-all shadow-md flex items-center gap-2">
                            <i class="fas fa-user-plus"></i> Add User/Staff
                        </button>
                    </div>

                    <div id="roles-container" class="space-y-6">
                        <div id="empty-roles" class="text-center py-20 border-2 border-dashed border-earth-700 rounded-2xl bg-earth-800/30">
                            <i class="fas fa-users-cog text-4xl text-earth-600 mb-4 animate-float"></i>
                            <p class="text-earth-400 text-sm">No users added yet. Click "Add User/Staff" to start.</p>
                        </div>
                    </div>
                </div>

                <div class="mt-8 flex justify-between items-center">
                    <div class="flex items-center gap-2 opacity-70">
                        <img src="https://ik.imagekit.io/tycncf0zq0/Bluv%20%20(1).png" class="w-5 h-5">
                        <span class="text-xs font-mono text-earth-400">Powered by Bluv</span>
                    </div>
                    <div class="flex gap-4">
                        <button type="button" onclick="changeStep(3)" class="text-earth-400 hover:text-white px-8 py-4 font-medium transition-colors">Back</button>
                        <button type="button" onclick="validateAndNext(4)" class="bg-tan-accent hover:bg-white text-earth-900 px-10 py-4 rounded-xl font-bold transition-all shadow-lg hover:shadow-tan-accent/50 transform hover:-translate-y-1">
                            Next Step <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- STEP 5: TECH STACK -->
            <div id="step-5" class="step-panel">
                <div class="glass-panel rounded-3xl p-8 md:p-12">
                    <div class="mb-10 border-b border-earth-700 pb-4">
                        <h1 class="text-4xl font-light text-white mb-2">Tech Info</h1>
                        <p class="text-earth-400">Final details & hosting infrastructure.</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                        <div class="space-y-4">
                            <label class="block text-xs font-bold text-tan-accent uppercase tracking-widest">Language</label>
                            <div class="relative opacity-75">
                                <select name="language" class="input-casual w-full p-4 rounded-xl text-earth-400 cursor-not-allowed" disabled>
                                    <option value="Python (discord.py)" selected>Python (discord.py)</option>
                                </select>
                                <i class="fas fa-lock absolute right-4 top-4 text-earth-500"></i>
                            </div>
                        </div>

                        <div class="space-y-4">
                            <label class="block text-xs font-bold text-tan-accent uppercase tracking-widest">Hosting</label>
                            <div class="relative opacity-75">
                                <input type="text" name="hosting" value="BDH (Bluv Development Hosting)" class="input-casual w-full p-4 rounded-xl text-tan-accent font-bold cursor-not-allowed" readonly>
                                <i class="fas fa-server absolute right-4 top-4 text-earth-500"></i>
                            </div>
                        </div>
                         <div class="space-y-4">
                            <label class="block text-xs font-bold text-tan-accent uppercase tracking-widest">Est. User Count (Optional)</label>
                            <input type="text" name="user_count" class="input-casual w-full p-4 rounded-xl" placeholder="e.g. 500 members">
                        </div>
                    </div>

                    <div class="p-6 bg-earth-900/50 rounded-xl border border-earth-700 mb-8 hover:border-tan-accent/30 transition-colors">
                        <div class="flex items-start gap-4">
                            <i class="fas fa-shield-alt text-2xl text-tan-accent mt-1"></i>
                            <div>
                                <h4 class="text-white font-bold mb-1">Privacy Guarantee</h4>
                                <p class="text-xs text-earth-400 leading-relaxed">
                                    We don't share any of your information. We swear by law not to use, sell, or claim your ideas or data without your explicit permission. Your privacy is our priority.
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <label class="block text-xs font-bold text-tan-accent uppercase tracking-widest">Any other notes? <span class="text-red-500">*</span></label>
                        <textarea name="notes" required class="input-casual w-full p-4 rounded-xl h-32 resize-none" placeholder="Do you need any specific APIs? Or have a deadline? Type 'None' if nothing."></textarea>
                        <p class="error-msg">This field is required.</p>
                    </div>
                </div>

                <div class="mt-8 flex justify-between items-center">
                    <div class="flex items-center gap-2 opacity-70">
                        <img src="https://ik.imagekit.io/tycncf0zq0/Bluv%20%20(1).png" class="w-5 h-5">
                        <span class="text-xs font-mono text-earth-400">Powered by Bluv</span>
                    </div>
                    <div class="flex gap-4 items-center">
                        <button type="button" onclick="changeStep(4)" class="text-earth-400 hover:text-white px-8 py-4 font-medium transition-colors">Back</button>
                        <button type="button" onclick="submitToWebhook()" id="submitBtn" class="bg-tan-accent hover:bg-white text-earth-900 px-12 py-5 rounded-xl font-bold tracking-wider text-sm shadow-xl hover:shadow-tan-accent/60 transform hover:-translate-y-1 transition-all">
                            <i class="fas fa-paper-plane mr-2"></i> SEND REQUEST
                        </button>
                    </div>
                </div>
            </div>

        </form>
    </main>
    
    <!-- Footer Links -->
    <footer class="fixed bottom-0 w-full bg-earth-900/95 backdrop-blur-lg border-t border-earth-700 z-40 py-3">
        <div class="max-w-6xl mx-auto px-6 flex flex-col md:flex-row justify-between items-center gap-4 text-xs font-mono text-earth-500">
             <div class="flex gap-6">
                 <a href="https://bluv-developer.github.io/Bots/Form" class="hover:text-tan-accent transition-colors">Current Form</a>
                 <a href="https://bluv-developer.github.io/Bots/" class="hover:text-tan-accent transition-colors">General Info</a>
                 <a href="https://bluv-developer.github.io/Bluv" class="hover:text-tan-accent transition-colors">Main Site</a>
             </div>
             <div>
                 &copy; 2025 Bluv Development
             </div>
        </div>
    </footer>

    <!-- Legal Modal -->
    <div id="legalModal" class="fixed inset-0 z-[150] hidden bg-earth-900/90 backdrop-blur-sm items-center justify-center p-4">
        <div class="glass-panel w-full max-w-lg p-8 rounded-2xl border border-tan-accent/30 relative shadow-2xl">
            <div id="legal-step-1">
                <div class="text-center mb-6">
                    <i class="fas fa-file-contract text-4xl text-tan-accent mb-4 animate-float"></i>
                    <h2 class="text-2xl font-bold text-white mb-2">Final Check</h2>
                    <p class="text-earth-300 text-sm">Wait, before submitting, do you agree to our Terms, Privacy Policy, and any applicable rules or legal documents?</p>
                </div>
                
                <div class="flex gap-4 justify-center mb-8">
                    <a href="https://bluv-developer.github.io/Bots/Terms" target="_blank" class="text-xs text-tan-accent border border-tan-accent/50 px-3 py-2 rounded hover:bg-tan-accent hover:text-earth-900 transition-colors">
                        <i class="fas fa-external-link-alt mr-1"></i> Terms of Service
                    </a>
                    <a href="https://bluv-developer.github.io/Bots/Privacy" target="_blank" class="text-xs text-tan-accent border border-tan-accent/50 px-3 py-2 rounded hover:bg-tan-accent hover:text-earth-900 transition-colors">
                        <i class="fas fa-external-link-alt mr-1"></i> Privacy Policy
                    </a>
                </div>

                <div class="flex gap-4 justify-center">
                    <button onclick="handleLegalNo()" class="px-6 py-3 rounded-xl border border-earth-600 text-earth-400 hover:text-white hover:border-earth-400 transition-colors text-sm font-bold">
                        No, I need to review
                    </button>
                    <button onclick="finalSubmit()" class="px-6 py-3 rounded-xl bg-tan-accent text-earth-900 hover:bg-white transition-colors text-sm font-bold shadow-lg shadow-tan-accent/20">
                        Yes, I Agree
                    </button>
                </div>
            </div>

            <div id="legal-step-2" class="hidden text-center">
                <i class="fas fa-clock text-4xl text-earth-400 mb-4"></i>
                <h3 class="text-xl font-bold text-white mb-2">Take your time</h3>
                <p class="text-earth-300 text-sm mb-6 leading-relaxed">
                    Sorry, please do not close this tab. We will wait for you to review the documents and information. All current information will be saved.
                </p>
                
                <div class="flex flex-col gap-3 items-center mb-8">
                     <a href="https://bluv-developer.github.io/Bots/Terms" target="_blank" class="text-tan-accent hover:underline text-sm">Read Terms of Service</a>
                     <a href="https://bluv-developer.github.io/Bots/Privacy" target="_blank" class="text-tan-accent hover:underline text-sm">Read Privacy Policy</a>
                </div>

                <button onclick="resetLegalModal()" class="px-8 py-3 rounded-xl bg-earth-700 text-white hover:bg-earth-600 transition-colors text-sm font-bold">
                    I have reviewed them
                </button>
            </div>
        </div>
    </div>

    <!-- Full Page Success Screen -->
    <div id="successScreen" class="fixed inset-0 z-[200] hidden bg-earth-900 flex-col items-center justify-start md:justify-center p-6 overflow-y-auto">
        <div class="max-w-4xl w-full bg-earth-800/50 border border-tan-accent/20 p-8 md:p-12 rounded-3xl shadow-2xl relative mt-10 md:mt-0 mb-20">
            <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-tan-accent via-earth-500 to-tan-accent opacity-50 rounded-t-3xl"></div>
            
            <div class="text-center mb-8">
                <div class="w-20 h-20 bg-tan-accent/10 rounded-full flex items-center justify-center mx-auto mb-6 border border-tan-accent/30 animate-float">
                    <i class="fas fa-check text-4xl text-tan-accent"></i>
                </div>
                <h1 class="text-4xl font-bold text-white mb-4">Submission Successful!</h1>
                <p class="text-earth-300 text-lg">Your bot specification has been securely transmitted.</p>
            </div>

            <div class="grid md:grid-cols-2 gap-8 mb-8">
                <div class="bg-earth-900/50 p-6 rounded-xl border border-earth-700">
                    <h3 class="text-tan-accent font-bold mb-3 uppercase tracking-widest text-xs">Why this helps</h3>
                    <p class="text-sm text-earth-400 leading-relaxed">
                        Providing detailed specifications helps us build your bot faster and more accurately without constant back-and-forth questions. We now have a blueprint to start coding immediately.
                    </p>
                </div>
                <div class="bg-earth-900/50 p-6 rounded-xl border border-earth-700">
                    <h3 class="text-tan-accent font-bold mb-3 uppercase tracking-widest text-xs">What happens next</h3>
                    <p class="text-sm text-earth-400 leading-relaxed">
                        Bluv or one of his official bots will contact you soon via Discord.
                    </p>
                    <div class="mt-4 p-3 bg-red-900/20 border border-red-500/30 rounded-lg">
                        <p class="text-xs text-red-300 font-bold flex items-center gap-2">
                            <i class="fas fa-shield-alt"></i> SECURITY NOTE:
                        </p>
                        <p class="text-[10px] text-red-200 mt-1">
                            Only official bots from <a href="https://discord.gg/KmHfjDm2WA" class="underline hover:text-white">The Official Discord Community</a> will contact you. Verify IDs before trusting DM's.
                        </p>
                    </div>
                </div>
            </div>

            <div class="bg-black/30 p-6 rounded-xl border border-earth-700 font-mono text-xs text-earth-400 mb-8">
                <p class="mb-4 text-tan-accent uppercase tracking-widest font-bold">Reference IDs (Save These)</p>
                <div class="grid grid-cols-1 gap-y-3 break-ids" id="generatedIds">
                    <!-- IDs injected here -->
                </div>
            </div>

            <div class="flex flex-col md:flex-row gap-4 justify-center">
                <a href="https://discord.gg/KmHfjDm2WA" class="bg-[#5865F2] hover:bg-[#4752c4] text-white px-8 py-4 rounded-xl font-bold transition-all text-center">
                    <i class="fab fa-discord mr-2"></i> Join Community
                </a>
                <button onclick="location.reload()" class="bg-earth-700 hover:bg-earth-600 text-white px-8 py-4 rounded-xl font-bold transition-all">
                    Submit Another
                </button>
            </div>
            
            <div class="mt-8 text-center opacity-50 flex justify-center items-center gap-2">
                 <img src="https://ik.imagekit.io/tycncf0zq0/Bluv%20%20(1).png" class="w-5 h-5 grayscale">
                 <span class="text-xs font-mono text-earth-500">Powered by Bluv</span>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Context Menu Logic
            const contextMenu = document.getElementById('custom-context-menu');
            document.addEventListener('contextmenu', (event) => {
                event.preventDefault();
                const { clientX: mouseX, clientY: mouseY } = event;
                contextMenu.style.top = `${mouseY}px`;
                contextMenu.style.left = `${mouseX}px`;
                contextMenu.style.display = 'block';
            });
            document.addEventListener('click', (e) => {
                if (e.target.offsetParent != contextMenu) {
                    contextMenu.style.display = 'none';
                }
            });

            // Prevent shortcuts/copy
            document.addEventListener('copy', (e) => { e.preventDefault(); return false; });
            document.addEventListener('cut', (e) => { e.preventDefault(); return false; });
            document.addEventListener('paste', (e) => { e.preventDefault(); return false; });
            document.addEventListener('dragstart', (e) => { e.preventDefault(); return false; });
        });

        // Global functions for onclick handlers
        
        // --- Color Picker Logic ---
        function handleColorChange() {
            const select = document.getElementById('colorSelect');
            const customInput = document.getElementById('customColorInput');
            const container = document.getElementById('customColorContainer');
            const preview = document.getElementById('colorPreview');
            const validationMsg = document.getElementById('colorValidationMsg');
            const selectedValue = select.value;

            if (selectedValue === 'custom') {
                container.classList.remove('hidden');
                preview.style.backgroundColor = 'transparent';
                customInput.required = true;
                customInput.focus();
                validateCustomColor(); 
            } else {
                container.classList.add('hidden');
                preview.style.backgroundColor = selectedValue;
                customInput.required = false;
                validationMsg.textContent = "";
            }
        }

        function validateCustomColor() {
            const customInput = document.getElementById('customColorInput');
            const preview = document.getElementById('colorPreview');
            const validationMsg = document.getElementById('colorValidationMsg');
            
            const val = customInput.value.trim();
            const s = new Option().style;
            s.color = val;
            
            if (s.color !== '') {
                preview.style.backgroundColor = val;
                validationMsg.textContent = "VALID COLOR";
                validationMsg.style.color = "#22c55e"; 
                customInput.classList.remove('input-error');
            } else {
                preview.style.backgroundColor = 'transparent';
                validationMsg.textContent = "INVALID COLOR";
                validationMsg.style.color = "#ef4444"; 
            }
        }
        
        // Attach input listener if element exists
        const customColorInput = document.getElementById('customColorInput');
        if(customColorInput) customColorInput.addEventListener('input', validateCustomColor);
        
        // --- Custom Category Logic ---
        function handleCategoryChange(selectElement) {
            const customInput = selectElement.nextElementSibling;
            if (selectElement.value === 'Custom') {
                customInput.classList.remove('hidden');
                customInput.focus();
                customInput.required = true;
            } else {
                customInput.classList.add('hidden');
                customInput.required = false;
            }
        }

        // --- Custom Field Logic ---
        function addCustomField(containerId) {
            const container = document.getElementById(containerId);
            const div = document.createElement('div');
            div.className = 'grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 bg-black/20 p-4 rounded-lg border border-earth-600/50 animate-fade-in';
            div.innerHTML = `
                <input type="text" class="input-casual w-full p-3 rounded-lg text-sm" placeholder="Your Question (e.g. Which channel?)">
                <input type="text" class="input-casual w-full p-3 rounded-lg text-sm" placeholder="Your Answer">
                <div class="md:col-span-2 text-right">
                    <button type="button" onclick="this.parentElement.parentElement.remove()" class="text-xs text-red-400 hover:text-red-300 underline">Remove Custom Detail</button>
                </div>
            `;
            container.appendChild(div);
        }

        // --- Form Navigation & Validation ---
        function changeStep(step) {
            document.querySelector('.step-panel.active').classList.remove('active');
            document.getElementById(`step-${step}`).classList.add('active');
            document.getElementById('step-indicator').innerText = `${step}`;
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function validateAndNext(current) {
            const currentPanel = document.getElementById(`step-${current}`);
            const inputs = currentPanel.querySelectorAll('input, select, textarea');
            let valid = true;

            inputs.forEach(input => {
                // Check if element is visible
                const isHidden = input.offsetParent === null;
                
                // Only validate visible fields
                if (!isHidden && !input.checkValidity()) {
                    input.classList.add('input-error');
                    valid = false;
                    input.addEventListener('input', () => input.classList.remove('input-error'), { once: true });
                }
                
                // Special check for custom color input if visible
                if (input.id === 'customColorInput' && !isHidden) {
                    const s = new Option().style;
                    s.color = input.value;
                    if(s.color === '') {
                        input.classList.add('input-error');
                        valid = false;
                    }
                }
            });

            if (!valid) return;

            // Logic Validation
            if (current === 2) {
                if (document.querySelectorAll('.command-row').length < 1) {
                    const banner = document.getElementById('cmd-error-banner');
                    banner.classList.remove('hidden');
                    setTimeout(() => banner.classList.add('hidden'), 5000);
                    return;
                }
            }
            if (current === 3) {
                if (document.querySelectorAll('.feature-row').length < 3) {
                    const banner = document.getElementById('feat-error-banner');
                    banner.classList.remove('hidden');
                    setTimeout(() => banner.classList.add('hidden'), 5000);
                    return;
                }
            }
            
            changeStep(current + 1);
        }

        function resetForm() {
            if(confirm("Clear all answers?")) {
                location.reload();
            }
        }

        // --- Dynamic Rows ---
        function addCommandRow() {
            document.getElementById('empty-commands').style.display = 'none';
            const container = document.getElementById('commands-container');
            const id = Date.now();
            
            const row = document.createElement('div');
            row.className = "command-row bg-earth-800/50 p-6 rounded-2xl border border-earth-700 animate-fade-in hover:border-tan-accent/30 transition-colors";
            row.id = `cmd-${id}`;
            row.innerHTML = `
                <div class="flex justify-between mb-4">
                    <span class="text-xs font-bold bg-tan-accent text-earth-900 px-2 py-1 rounded">CMD</span>
                    <i class="fas fa-trash text-earth-500 hover:text-red-400 cursor-pointer" onclick="document.getElementById('cmd-${id}').remove()"></i>
                </div>
                <div class="space-y-4" id="cmd-fields-${id}">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                         <div>
                            <label class="block text-[10px] text-earth-400 mb-1">Command Name <span class="text-red-500">*</span></label>
                            <input type="text" required class="input-casual w-full p-3 rounded-lg text-lg font-mono" placeholder="/name">
                         </div>
                         <div>
                            <label class="block text-[10px] text-earth-400 mb-1">Who can use this? <span class="text-red-500">*</span></label>
                            <input type="text" required class="input-casual w-full p-3 rounded-lg text-sm" placeholder="e.g. Everyone, Admins, Mods">
                         </div>
                    </div>
                    <div>
                        <label class="block text-[10px] text-earth-400 mb-1">Description <span class="text-red-500">*</span></label>
                        <input type="text" required class="input-casual w-full p-3 rounded-lg text-sm" placeholder="What does it do?">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-[10px] text-earth-400 mb-1">Category</label>
                            <select onchange="handleCategoryChange(this)" class="input-casual w-full p-3 rounded-lg text-sm cursor-pointer mb-2">
                                <option>General</option>
                                <option>Admin</option>
                                <option>Fun</option>
                                <option>Economy</option>
                                <option>Moderation</option>
                                <option>Custom</option>
                            </select>
                            <input type="text" class="input-casual w-full p-3 rounded-lg text-sm hidden" placeholder="Enter Category Name">
                        </div>
                        <div>
                            <label class="block text-[10px] text-earth-400 mb-1">Cooldown (sec)</label>
                            <input type="number" class="input-casual w-full p-3 rounded-lg text-sm" placeholder="0">
                        </div>
                    </div>
                    <div id="cmd-custom-${id}"></div>
                    <button type="button" onclick="addCustomField('cmd-custom-${id}')" class="text-xs text-tan-accent hover:text-white underline decoration-dashed underline-offset-4">
                        + Add Custom Detail/Question
                    </button>
                </div>
            `;
            container.appendChild(row);
        }

        function addFeatureRow() {
            document.getElementById('empty-features').style.display = 'none';
            const container = document.getElementById('features-container');
            const id = Date.now();
            
            const row = document.createElement('div');
            row.className = "feature-row bg-earth-800/50 p-6 rounded-2xl border border-earth-700 animate-fade-in hover:border-tan-accent/30 transition-colors";
            row.id = `feat-${id}`;
            row.innerHTML = `
                <div class="flex justify-between mb-4">
                    <span class="text-xs font-bold bg-earth-600 text-white px-2 py-1 rounded">FEATURE</span>
                    <i class="fas fa-trash text-earth-500 hover:text-red-400 cursor-pointer" onclick="document.getElementById('feat-${id}').remove()"></i>
                </div>
                <div class="space-y-4" id="feat-fields-${id}">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                             <label class="block text-[10px] text-earth-400 mb-1">Feature Name <span class="text-red-500">*</span></label>
                             <input type="text" required class="input-casual w-full p-3 rounded-lg text-lg font-mono" placeholder="e.g. Welcome Message">
                        </div>
                        <div>
                             <label class="block text-[10px] text-earth-400 mb-1">Config Needed? <span class="text-red-500">*</span></label>
                             <input type="text" required class="input-casual w-full p-3 rounded-lg text-sm" placeholder="e.g. Needs Channel ID, Role ID">
                        </div>
                    </div>
                    <div>
                        <label class="block text-[10px] text-earth-400 mb-1">How does it work? <span class="text-red-500">*</span></label>
                        <textarea required class="input-casual w-full p-3 rounded-lg text-sm h-20 resize-none" placeholder="Explain the logic in detail."></textarea>
                    </div>
                    <div id="feat-custom-${id}"></div>
                    <button type="button" onclick="addCustomField('feat-custom-${id}')" class="text-xs text-tan-accent hover:text-white underline decoration-dashed underline-offset-4">
                        + Add Custom Detail/Question
                    </button>
                </div>
            `;
            container.appendChild(row);
        }
        
        // --- Roles & Permissions Logic ---
        function addRoleRow() {
            document.getElementById('empty-roles').style.display = 'none';
            const container = document.getElementById('roles-container');
            const id = Date.now();
            
            const row = document.createElement('div');
            row.className = "role-row bg-earth-800/50 p-6 rounded-2xl border border-earth-700 animate-fade-in hover:border-tan-accent/30 transition-colors";
            row.id = `role-${id}`;
            row.innerHTML = `
                <div class="flex justify-between mb-4">
                    <span class="text-xs font-bold bg-purple-500 text-white px-2 py-1 rounded">USER/ROLE</span>
                    <i class="fas fa-trash text-earth-500 hover:text-red-400 cursor-pointer" onclick="document.getElementById('role-${id}').remove()"></i>
                </div>
                <div class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                             <label class="block text-[10px] text-earth-400 mb-1">Username <span class="text-red-500">*</span></label>
                             <input type="text" required class="input-casual w-full p-3 rounded-lg text-sm" placeholder="User#0000">
                        </div>
                        <div>
                             <label class="block text-[10px] text-earth-400 mb-1">Discord ID <span class="text-red-500">*</span></label>
                             <input type="text" required class="input-casual w-full p-3 rounded-lg text-sm" placeholder="123456789...">
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                         <div>
                            <label class="block text-[10px] text-earth-400 mb-1">Top 3 Roles <span class="text-red-500">*</span></label>
                            <input type="text" required class="input-casual w-full p-3 rounded-lg text-sm" placeholder="e.g. Owner, Admin, Mod">
                         </div>
                         <div>
                            <label class="block text-[10px] text-earth-400 mb-1">What do they do? <span class="text-red-500">*</span></label>
                            <input type="text" required class="input-casual w-full p-3 rounded-lg text-sm" placeholder="e.g. Manages the server">
                         </div>
                    </div>

                    <!-- Presets -->
                    <div>
                        <label class="block text-[10px] text-earth-400 mb-2">Preset Permissions</label>
                        <div class="flex flex-wrap gap-2">
                             ${createPresetRadio(id, 'Owner', true)}
                             ${createPresetRadio(id, 'Admin', true)}
                             ${createPresetRadio(id, 'Mod', false)}
                             ${createPresetRadio(id, 'Trial', false)}
                             ${createPresetRadio(id, 'Extra', false)}
                        </div>
                        <div id="danger-warning-${id}" class="hidden mt-2 text-xs text-red-400 bg-red-900/20 p-2 rounded border border-red-500/30 flex items-center gap-2">
                            <i class="fas fa-exclamation-triangle animate-flash-red"></i> 
                            <span>Warning: This preset grants dangerous high-level permissions.</span>
                        </div>
                        <div id="preset-info-${id}" class="hidden mt-2 text-xs text-tan-accent bg-tan-accent/10 p-2 rounded border border-tan-accent/30">
                            <!-- JS fills this -->
                        </div>
                    </div>

                    <!-- Manual Perms -->
                    <div>
                        <button type="button" onclick="document.getElementById('perms-grid-${id}').classList.toggle('hidden')" class="text-xs text-earth-400 hover:text-white flex items-center gap-1 mb-2">
                            <i class="fas fa-cog"></i> Configure Permissions Manually
                        </button>
                        <div id="perms-grid-${id}" class="hidden grid grid-cols-2 md:grid-cols-3 gap-2 bg-black/20 p-4 rounded-lg">
                            ${createPermCheckbox('Administrator', true)}
                            ${createPermCheckbox('Manage Server', true)}
                            ${createPermCheckbox('Manage Roles', true)}
                            ${createPermCheckbox('Manage Channels', true)}
                            ${createPermCheckbox('Ban Members', true)}
                            ${createPermCheckbox('Kick Members', true)}
                            ${createPermCheckbox('Manage Messages', true)}
                            ${createPermCheckbox('Manage Webhooks', true)}
                            ${createPermCheckbox('Mention Everyone', true)}
                            ${createPermCheckbox('View Audit Log', false)}
                            ${createPermCheckbox('Manage Emojis', false)}
                            ${createPermCheckbox('Change Nickname', false)}
                            ${createPermCheckbox('Manage Nicknames', false)}
                            ${createPermCheckbox('Send Messages', false)}
                            ${createPermCheckbox('Embed Links', false)}
                            ${createPermCheckbox('Attach Files', false)}
                            ${createPermCheckbox('Add Reactions', false)}
                            ${createPermCheckbox('Connect', false)}
                            ${createPermCheckbox('Speak', false)}
                            ${createPermCheckbox('Mute Members', false)}
                            ${createPermCheckbox('Deafen Members', false)}
                            ${createPermCheckbox('Move Members', false)}
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-[10px] text-earth-400 mb-1">Notes on User</label>
                        <textarea class="input-casual w-full p-3 rounded-lg text-sm h-16 resize-none" placeholder="Any specific details?"></textarea>
                    </div>
                </div>
            `;
            container.appendChild(row);
        }

        function createPresetRadio(id, name, isDangerous) {
            const dangerClass = isDangerous ? 'text-red-400' : 'text-earth-300';
            return `
                <label class="cursor-pointer bg-earth-700/50 border border-earth-600 px-3 py-1.5 rounded-lg flex items-center gap-2 hover:bg-earth-600 transition-colors">
                    <input type="radio" name="preset-${id}" value="${name}" class="hidden peer" onclick="handlePresetClick('${id}', '${name}', ${isDangerous})">
                    <span class="text-xs ${dangerClass} peer-checked:text-white font-bold">${name}</span>
                    <i class="fas fa-info-circle text-[10px] text-earth-500 hover:text-white" onclick="showPresetInfo('${id}', '${name}', event)"></i>
                </label>
            `;
        }

        function createPermCheckbox(name, isDangerous) {
            const dangerIcon = isDangerous ? `<i class="fas fa-exclamation-circle text-red-500 text-xs ml-1 danger-icon"></i><div class="danger-tooltip">Dangerous: Grants high-level control.</div>` : '';
            return `
                <label class="flex items-center gap-2 cursor-pointer relative">
                    <input type="checkbox" class="perm-checkbox w-3 h-3 rounded border-earth-500 bg-earth-800 text-tan-accent focus:ring-0">
                    <span class="text-xs text-earth-300 select-none">${name}</span>
                    ${dangerIcon}
                </label>
            `;
        }

        function handlePresetClick(id, preset, isDangerous) {
            const warning = document.getElementById(`danger-warning-${id}`);
            if (isDangerous) {
                warning.classList.remove('hidden');
            } else {
                warning.classList.add('hidden');
            }
            // Auto-check permissions based on preset (Simple logic for demo)
            const checkboxes = document.querySelectorAll(`#perms-grid-${id} input[type="checkbox"]`);
            checkboxes.forEach(cb => {
                const label = cb.nextElementSibling.innerText;
                cb.checked = false; // Reset
                if (preset === 'Owner') cb.checked = true;
                if (preset === 'Admin' && label !== 'Administrator') cb.checked = true; // Admin gets most except straight Admin sometimes
                if (preset === 'Mod' && (label.includes('Message') || label.includes('Kick') || label.includes('Mute'))) cb.checked = true;
                if (preset === 'Trial' && (label.includes('Message') || label.includes('Mute'))) cb.checked = true;
            });
        }

        function showPresetInfo(id, preset, e) {
            e.preventDefault();
            e.stopPropagation();
            const infoBox = document.getElementById(`preset-info-${id}`);
            let text = "";
            if(preset === 'Owner') text = "Has FULL access to everything. Be careful.";
            if(preset === 'Admin') text = "Can manage server settings, roles, channels, and ban members.";
            if(preset === 'Mod') text = "Can manage messages, kick members, and mute/timeout.";
            if(preset === 'Trial') text = "Limited access. Usually just muting or basic moderation.";
            if(preset === 'Extra') text = "Custom role with no specific defaults.";
            
            infoBox.innerText = text;
            infoBox.classList.remove('hidden');
            setTimeout(() => infoBox.classList.add('hidden'), 5000);
        }

        // --- ID Generator ---
        function generateId(prefix) {
            return prefix + '-' + Math.random().toString(36).substr(2, 9).toUpperCase();
        }

        // --- Legal Modal Logic ---
        function submitToWebhook() {
            // First, trigger HTML5 validation on Step 5 fields
            const currentPanel = document.getElementById(`step-5`);
            const inputs = currentPanel.querySelectorAll('input, select, textarea');
            let valid = true;
            inputs.forEach(input => {
                if (input.offsetParent !== null && !input.checkValidity()) { 
                    input.classList.add('input-error');
                    valid = false;
                    input.addEventListener('input', () => input.classList.remove('input-error'), { once: true });
                }
            });
            
            if (!valid) return;

            // Open Modal
            document.getElementById('legalModal').classList.remove('hidden');
            document.getElementById('legalModal').classList.add('flex');
        }

        function handleLegalNo() {
            document.getElementById('legal-step-1').classList.add('hidden');
            document.getElementById('legal-step-2').classList.remove('hidden');
        }

        function resetLegalModal() {
            document.getElementById('legal-step-2').classList.add('hidden');
            document.getElementById('legal-step-1').classList.remove('hidden');
        }

        // --- Final Submission ---
        async function finalSubmit() {
            // Hide modal, show loading on button (behind modal basically)
            document.getElementById('legalModal').classList.add('hidden');
            document.getElementById('legalModal').classList.remove('flex');
            
            const btn = document.getElementById('submitBtn');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Processing...';
            btn.disabled = true;
            btn.classList.add('opacity-50', 'cursor-not-allowed');

            const webhookURL = "https://discord.com/api/webhooks/1447128249938214913/pLN2yVBVOzBeFzVVkCi1ybFOGvaXAGurrwPfwQ3FziGdnC5Jdm7X6KwjueCN5A0-YPZ-";
            const form = document.getElementById('botForm');
            const fd = new FormData(form);

            // Generate IDs
            const orderId = generateId('ORD');
            const bluvId = generateId('BLV');
            const unitId = generateId('UNT');
            const authId = generateId('AUTH');
            const traceId = generateId('TRC');

            // 1. Send Identity
            const colorSelection = document.getElementById('colorSelect').value === 'custom' ? document.getElementById('customColorInput').value : document.getElementById('colorSelect').value;
            
            let identityMsg = "**New Bot Request [1/4]: Identity** \n";
            identityMsg += `**IDs:** Order: \`${orderId}\` | Bluv: \`${bluvId}\` | Unit: \`${unitId}\`\n`;
            identityMsg += `**Client:** ${fd.get('client_discord')} (${fd.get('client_id')})\n`;
            identityMsg += `**Server:** ${fd.get('server_name')} (<${fd.get('server_invite')}>)\n`;
            identityMsg += `**Bot:** ${fd.get('bot_name')} | Prefix: \`${fd.get('bot_prefix')}\` | Status: ${fd.get('bot_status')}\n`;
            identityMsg += `**Theme:** ${colorSelection}\n`;
            identityMsg += `**Tech:** Python (discord.py) | Hosting: BDH\n`;
            identityMsg += `**Notes:** ${fd.get('notes')}\n`;
            if(fd.get('client_timezone')) identityMsg += `**Timezone:** ${fd.get('client_timezone')}\n`;
            if(fd.get('user_count')) identityMsg += `**Est Users:** ${fd.get('user_count')}`;

            try {
                await sendWebhook(webhookURL, identityMsg);

                // 2. Commands
                const cmdRows = document.querySelectorAll('.command-row');
                let cmdMsg = "**New Bot Request [2/4]: Commands** \n\n";
                
                for (let i = 0; i < cmdRows.length; i++) {
                    const row = cmdRows[i];
                    const name = row.querySelector('input[placeholder="/name"]').value;
                    const who = row.querySelector('input[placeholder*="Everyone"]').value;
                    const desc = row.querySelector('input[placeholder*="What does it"]').value;
                    let cat = row.querySelector('select').value;
                    if(cat === 'Custom') cat = row.querySelector('input[placeholder="Enter Category Name"]').value;
                    const cool = row.querySelector('input[placeholder="0"]').value;
                    
                    let customTxt = "";
                    const customDivs = row.querySelectorAll('[id^="cmd-custom"] > div');
                    customDivs.forEach(div => {
                        const q = div.querySelectorAll('input')[0].value;
                        const a = div.querySelectorAll('input')[1].value;
                        if(q && a) customTxt += `    - *${q}:* ${a}\n`;
                    });

                    const entry = `**${i+1}. /${name}**\n   - Desc: ${desc}\n   - Perms: ${who}\n   - Cat: ${cat} | Cooldown: ${cool}s\n${customTxt}\n`;
                    
                    if ((cmdMsg + entry).length > 1900) {
                        await sendWebhook(webhookURL, cmdMsg);
                        cmdMsg = "**Commands Continued...**\n" + entry;
                    } else {
                        cmdMsg += entry;
                    }
                }
                if(cmdRows.length > 0) await sendWebhook(webhookURL, cmdMsg);

                // 3. Features
                const featRows = document.querySelectorAll('.feature-row');
                let featMsg = "**New Bot Request [3/4]: Features** \n\n";

                for (let i = 0; i < featRows.length; i++) {
                    const row = featRows[i];
                    const name = row.querySelector('input[placeholder*="Welcome"]').value;
                    const config = row.querySelector('input[placeholder*="Needs Channel"]').value;
                    const logic = row.querySelector('textarea').value;

                    let customTxt = "";
                    const customDivs = row.querySelectorAll('[id^="feat-custom"] > div');
                    customDivs.forEach(div => {
                        const q = div.querySelectorAll('input')[0].value;
                        const a = div.querySelectorAll('input')[1].value;
                        if(q && a) customTxt += `    - *${q}:* ${a}\n`;
                    });

                    const entry = `**${i+1}. [${name}]**\n   - Config: ${config}\n   - Logic: ${logic}\n${customTxt}\n`;

                    if ((featMsg + entry).length > 1900) {
                        await sendWebhook(webhookURL, featMsg);
                        featMsg = "**Features Continued...**\n" + entry;
                    } else {
                        featMsg += entry;
                    }
                }
                if(featRows.length > 0) await sendWebhook(webhookURL, featMsg);
                
                // 4. Roles
                const roleRows = document.querySelectorAll('.role-row');
                let roleMsg = "**New Bot Request [4/4]: Roles & Staff** \n\n";
                
                for (let i = 0; i < roleRows.length; i++) {
                    const row = roleRows[i];
                    const inputs = row.querySelectorAll('input[type="text"]');
                    const username = inputs[0].value;
                    const id = inputs[1].value;
                    const roles = inputs[2].value;
                    const desc = inputs[3].value;
                    const notes = row.querySelector('textarea').value;
                    
                    // Get checked preset
                    const presetChecked = row.querySelector('input[type="radio"]:checked');
                    const preset = presetChecked ? presetChecked.value : "None";
                    
                    // Get Manual Perms
                    const perms = [];
                    row.querySelectorAll('.perm-checkbox:checked').forEach(cb => {
                        perms.push(cb.nextElementSibling.innerText);
                    });
                    
                    const entry = `**${i+1}. ${username}** (${id})\n   - Roles: ${roles}\n   - Duty: ${desc}\n   - Preset: **${preset}**\n   - Perms: ${perms.join(', ') || 'None'}\n   - Notes: ${notes}\n\n`;
                    
                    if ((roleMsg + entry).length > 1900) {
                        await sendWebhook(webhookURL, roleMsg);
                        roleMsg = "**Roles Continued...**\n" + entry;
                    } else {
                        roleMsg += entry;
                    }
                }
                if(roleRows.length > 0) await sendWebhook(webhookURL, roleMsg);

                // Populate Success Screen with IDs
                const idContainer = document.getElementById('generatedIds');
                idContainer.innerHTML = `
                    <div class="flex flex-col md:flex-row md:justify-between border-b border-earth-700 pb-2 mb-2"><span class="text-earth-400">Order ID:</span> <span class="text-white font-bold select-all">${orderId}</span></div>
                    <div class="flex flex-col md:flex-row md:justify-between border-b border-earth-700 pb-2 mb-2"><span class="text-earth-400">Bluv ID:</span> <span class="text-white font-bold select-all">${bluvId}</span></div>
                    <div class="flex flex-col md:flex-row md:justify-between border-b border-earth-700 pb-2 mb-2"><span class="text-earth-400">Unit ID:</span> <span class="text-white font-bold select-all">${unitId}</span></div>
                    <div class="flex flex-col md:flex-row md:justify-between border-b border-earth-700 pb-2 mb-2"><span class="text-earth-400">Auth ID:</span> <span class="text-white font-bold select-all">${authId}</span></div>
                    <div class="flex flex-col md:flex-row md:justify-between pb-2"><span class="text-earth-400">Trace ID:</span> <span class="text-white font-bold select-all">${traceId}</span></div>
                `;

                // Show Success Page
                document.querySelector('main').style.display = 'none';
                document.querySelector('header').style.display = 'none';
                document.getElementById('successScreen').classList.remove('hidden');
                document.getElementById('successScreen').classList.add('flex');
                window.scrollTo(0,0);

            } catch (err) {
                console.error(err);
                alert("Failed to send. Please check your internet or try again.");
                btn.disabled = false;
                btn.innerHTML = 'SEND REQUEST';
                btn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        }

        async function sendWebhook(url, content) {
            const response = await fetch(url, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ content: content })
            });
            if (!response.ok) throw new Error("Webhook Error");
            await new Promise(r => setTimeout(r, 500)); 
        }
    </script>
</body>
</html>
